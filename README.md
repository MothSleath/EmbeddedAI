# Predictive Maintenance on STM32L4R9 Discovery Board

This repository showcases an **educational project** aiming to implement a **predictive maintenance model** on an **STM32L4R9 Discovery board**. The goal is to detect potential machine failures in a manufacturing setting by deploying a trained AI model onto the microcontroller. Below you will find an overview of the project structure and step-by-step instructions on how to set it up and run it.

---

## Project Overview

1. **Model Training (Google Colab)**  
   - A notebook (`TP_IA_EMBARQUEE.ipynb`) demonstrates how the dataset is used and how the predictive maintenance model is trained.  
   - The final model is exported in various formats (`.h5`, `.tflite`) to accommodate compatibility with STM32CubeIDE.

2. **STM32CubeIDE Project**  
   - The archive `STM32CubeIDEProject.zip` contains the complete source code for the microcontroller.  
   - This code handles **receiving input data** from a Python script over UART, **running inference** on the STM32 board, and **sending inference results** back to the Python script.

3. **Python Communication Script**  
   - `Communication_STM32_NN.py` sends test data (features) to the STM32 board and receives the model’s output predictions via UART.

4. **Dataset & Model Files**  
   - `ai4i2020.csv`: The original dataset used for training, testing, and inference.  
   - `modelEmbeddedAI.h5` & `modelEmbeddedAI.tflite`: Trained model files. The `.tflite` version is often used in STM32CubeIDE to bypass version-compatibility issues.  
   - `model_analyse_report.txt`: An analysis report generated by STM32CubeIDE, detailing model parameters, memory usage, and performance.

---

## Repository Contents

- **Communication_STM32_NN.py**  
  Python script for sending input data and receiving inference results from the STM32 board.

- **STM32CubeIDEProject.zip**  
  Complete STM32CubeIDE project (including the `.ioc` configuration file and source code).  
  - *Unzip and open in STM32CubeIDE to explore or modify the firmware.*

- **TP_IA_EMBARQUEE.ipynb**  
  Google Colab notebook demonstrating the educational process of training and exporting the AI model.

- **ai4i2020.csv**  
  The dataset used throughout the project (from training to inference).

- **modelEmbeddedAI.h5** / **modelEmbeddedAI.tflite**  
  Trained AI model in two formats.  
  - Use `.tflite` within STM32CubeIDE if `.h5` compatibility is an issue.

- **model_analyse_report.txt**  
  Report from STM32CubeIDE detailing the model’s structure and resource usage.

- **README.md**  
  This file, explaining how to set up and run the project.

---

## Getting Started

Below is a general outline of how to run this project from end to end.

### 1. Clone the Repository
```
git clone https://github.com/YourUsername/YourRepoName.git
```
*(Or download the ZIP from GitHub.)*

### 2. Open the STM32CubeIDE Project
1. Extract `STM32CubeIDEProject.zip` into a directory of your choice.
2. Launch **STM32CubeIDE** and select **File > Open Projects from File System**.
3. Point to the extracted folder. The `.ioc` file and all source files should appear in the Project Explorer.

### 3. Build and Flash the Firmware
1. (Optional) **Clean** the project to remove any previous build artifacts.
2. **Build** the project to generate the firmware.
3. **Flash** (program) the STM32L4R9 Discovery board by pressing the **Run** or **Debug** button in STM32CubeIDE.

### 4. Connect via UART and Run the Python Script
1. **Connect** your STM32 board to your PC (via ST-Link or a virtual COM port).  
2. Verify the COM port in your system’s device manager.  
3. Open a terminal or IDE and run:
   ```bash
   python Communication_STM32_NN.py
   ```
4. The Python script will:
   - **Synchronize** with the board.
   - Send test features (from `X_test`).
   - **Receive** inference results (probabilities or predicted labels).

### 5. Check the Results
- The script prints both **expected outputs** and **received outputs**.
- You can compare them to verify the model’s accuracy in real-time.

---

## Troubleshooting
- **UART Connection**: Ensure your baud rate and COM port settings in `Communication_STM32_NN.py` match those configured in STM32CubeIDE.  
- **Model Format**: If `.h5` causes issues in STM32CubeIDE, use the `.tflite` model instead.  
- **Dependencies**: In Python, you may need to install libraries like `pyserial` or `numpy` (`pip install pyserial numpy`).
